<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <!-- Metadata section: character encoding, viewport settings, title -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Preconnect to Google Fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- Link to Google Fonts stylesheet -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <!-- Link to Font Awesome stylesheet -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Link to Material Symbols stylesheet -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,300,0,0"
    />
    <!-- Link to the custom admin CSS file -->
    <link rel="stylesheet" href="{% static 'css/admin.css' %}" />
    <style>
      /* Reset margin, padding, and set the default font */
* {
    margin: 0;
    padding: 0;
    font-family: "Inter", sans-serif;
}

#number-avail span {
    display: block;
}

span.bus-count {
    font-size: 3rem;
}

/* Define root variables for consistent theme colors */
:root {
    --brand-color: #14723498;
    --brand-color-lt: #0D4116;
    --darkest-color: #000000;
    --dark-color: #363636;
    --mid-color: #6C6C6C;
    --light-color: #DADADA;
    --lightest-color: #FFFFFF;
}

/* Main body layout styling */
.main-body {
    display: flex;
    align-items: center;
}

/* Admin panel styling */
.dash-nav {
    height: 100vh;
    flex: 1;
    background-color: var(--brand-color-lt);
    z-index: 2;
}

.dash-screen {
    height: 100vh;
    flex: 4.5;
    background-color: #8080803d;
    display: flex;
    flex-direction: column;
}

.dash-screen-main {
    height: 100%;
    overflow: auto;
    overflow-x: hidden;
}

/* Top logo section styling */
.top-logo {
    display: flex;
    align-items: center;
    padding: 2rem .5rem;
    color: #fff;
}

.top-logo h2 {
    margin-left: 5px;
}

.top-logo span {
    font-size: 30px;
}

/* Navigation button styling */
.nav-btns ul {
    list-style-type: none;
}

.nav-btns button {
    cursor: pointer;
    background-color: transparent;
    text-align: left;
    border: none;
    display: flex;
    width: 100%;
    padding: 1rem;
    color: #fff;
    transition: .6s;
    align-items: center;
}

.nav-btns button span, 
.nav-btns button i {
    margin-right: 10px;
}

.nav-btns button:hover {
    background-color: rgba(190, 190, 190, 0.285);
}

.nav-btns button.active {
    background-color: var(--brand-color);
    border-left: 2px solid #fff;
}

/* Top screen bar styling */
.dash-top-screen {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    z-index: 1;
    background-color: #fff;
    box-shadow: -1px -7px 20px 0px #808080c2;
}

.top-screen-right {
    display: flex;
    align-items: stretch;
}

.search-bar {
    font-size: 20px;
    width: 250px;
    border: none;
    background-color: #8080803d;
    padding: 5px 10px;
    border-radius: 50px;
}

/* User section styling */
.user-sect {
    display: flex;
    align-items: center;
    background-color: rgba(206, 205, 205, 0.632);
    margin: 0 1rem;
    font-size: large;
    padding: 5px;
    border-radius: 50px;
}

.user-sect p {
    padding: 0 5px;
}

.user-sect i {
    padding: 5px;
    background-color: var(--brand-color-lt);
    color: #fff;
    border-radius: 50px;
}

/* Logout button styling */
.logout {
    cursor: pointer;
    border: none;
    border-radius: 10px;
    display: flex;
    color: #fff;
    background-color: var(--dark-color);
    padding: 5px;
}

/* Main screen elements styling */
.dash-screen-main .main-contained {
    width: 100%;
    height: 100%;
}

.dash-screen-main .main-contained>div {
    display: none;
}

.dash-screen-main .main-contained>div.active {
    position: relative;
    display: block;
    width: 100%;
    height: 100%;
}

/* Overview box container styling */
.overview-box-cont {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin: 3rem 0.4rem;
    /* padding: 1rem; */
}

.overview-box {
    width: 100%;
    height: 130px;
    border-radius: 10px;
    background-color: white;
    display: flex;
    position: relative;
    margin: 0 13px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 5px 13px;
    justify-content: space-between;
}

.overview-box h3 {
    text-align: center;
}

#buses-count {
    display: flex;
    /* justify-content: center; */
    grid: 1fr / 1fr 1fr;
    align-items: center;
    gap: 5px;
}

#count-icons {
    position: absolute;
    bottom: 20px;
    right: 15px;
    transform: scale(4.5);
    color: #159f44ad;
}

.material-symbols-rounded {
    margin-right: 5px;
}

/* Overview tables styling */
.overview-tables {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: 70%;
    background-color: var(--brand-color);
    border-radius: 10px;
}

.ov-table {
    width: 100%;
    height: 500px;
    border-radius: 10px;
    background-color: white;
    display: flex;
    margin: 0 10px;
}

.ov-table img {
    width: 40rem;
    height: 30rem;
    border-radius: 5px;
    border-color: bisque;
}

/* Form row styling */
.row {
    margin-bottom: 10px;
}

.row form {
    display: flex;
}

.row input {
    width: 100%;
    padding: 10px;
    margin: 0 10px 0 0;
    border-radius: 5px;
    font-size: 1rem;
    border: none;
}

.row button {
    padding: 10px;
    background-color: var(--brand-color-lt);
    border: none;
    border-radius: 5px;
    color: #fff;
}

.row select {
    width: 100%;
    margin: 0 10px;
    padding: 5px;
    border-radius: 5px;
    border: 1px solid var(--brand-color-lt);
}

/* Screen table name styling */
.screen-table-name {
    margin: 10px 0;
}

/* Screen top container styling */
.screen-top-contained,
.stc-left,
.btn-cont-rf {
    display: flex;
    align-items: center;
}

.screen-top-contained {
    justify-content: space-between;
    margin: 10px;
}

.btn-cont-rf button {
    margin: 0 10px;
}

.btn-cont-rf p#rf-state {
    color: rgb(132, 132, 132);
}

/* Refresh button styling */
.refresh-button {
    color: var(--brand-color);
    cursor: pointer;
    border: 1px solid;
    border-color: currentColor;
    display: flex;
    padding: 5px;
    border-radius: 100%;
    font-size: medium;
    align-items: center;
    justify-content: center;
}

/* Button actions styling */
.btn-actions {
    background-color: var(--brand-color-lt);
    border-radius: 5px;
    padding: 2px;
    color: white;
    display: flex;
}

.active-action-btn {
    cursor: pointer;
    background-color: transparent;
    border: none;
    display: flex;
    font-size: medium;
    color: white;
    align-items: center;
}

/* Dropdown toggle styling */
.dropdown-toggle {
    position: relative;
    background-color: transparent;
    border: none;
    color: #fff;
    cursor: pointer;
    padding: 5px 7px;
    border-radius: 10px;
    transition: .6s;
}

.dropdown-toggle.open {
    transform: rotate(180deg);
}

/* Dropdown menu styling */
.dropdown-menu {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 120px;
    padding: 5px;
    border-radius: 10px;
    transform: translate(-2rem, .5rem);
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    z-index: 1;
}

/* Dropdown item button styling */
button.dropdown-item {
    padding: 12px;
    background-color: transparent;
    border: none;
    text-align: left;
    border-radius: 10px;
}

/* Hover effect for dropdown items */
.dropdown-menu button:hover {
    background-color: #f1f1f1;
}

/* Show dropdown menu when active */
.dropdown-menu.active {
    display: flex;
    flex-direction: column;
}

/* Table styles */
table {
    width: 100%;
    max-height: 80%;
    border-collapse: collapse;
    margin-bottom: 20px;
    border-radius: 5px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    text-transform: capitalize;
}

table button {
    margin-right: 10px;
    background-color: transparent;
    font-size: medium;
    border: none;
    cursor: pointer;
}

table button.delete {
    margin-right: 0;
    color: rgb(211, 3, 3);
}

th, td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

th {
    background-color: #f2f2f2;
    transition: .6s;
    font-weight: bold;
}

/* Alternate row colors */
tbody tr:nth-child(even) {
    background-color: #f9f9f9;
}

/* Hover effect for table rows */
tbody tr:hover {
    background-color: #e9e9e9;
}

/* Form styling */
.add-form.active {
    width: 100%;
    position: absolute;
    top: 0px;
    height: 80%;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0px 1px 10px 0 #80808026;
}

/* Pagination and pagination button styling */
#pagination {
    display: flex;
    padding: 10px;
    text-align: center;
    justify-content: center;
    align-items: center;
}

#pagination button {
    cursor: pointer;
    font-size: large;
    padding: 5px;
    color: var(--brand-color);
    display: flex;
    border-radius: 100px;
    border: none;
    background-color: transparent;
    transition: .6s;
}

/* Main form container styling */
.all-main-forms, .main-form-all {
    display: none;
}

.main-form-all.active {
    display: flex;
    width: 100%;
    height: 100%;
    align-items: center;
    justify-content: center;
    z-index: 10;
    flex-direction: column;
}

.main-form-all.active .form-inner-con {
    border-radius: 10px;
    padding: 20px;
    background-color: #fff;
    text-align: center;
    width: 85%;
}

.main-form-all.active h2 {
    margin-bottom: 10px;
}

.main-form-all.active .grid-container {
    display: grid;
    gap: 10px;
    grid-row-end: 3;
    grid-column-end: 2;
}

.main-form-all.active .grid-item {
    margin-top: 10px;
}

.main-form-all.active .grid-item.item * {
    display: block;
    width: 100%;
    text-align: center;
}

.main-form-all.active label {
    margin-bottom: 5px;
}

.main-form-all.active input, 
.main-form-all.active select {
    background-color: lightgrey;
    padding: 5px 0px;
    border-radius: 10px;
    font-size: 1.2rem;
    border: none;
}

.main-form-all.active .item7 {
    grid-column: 1 / span 2;
    grid-row: 4;
    text-align: center;
}

.main-form-all.active button {
    color: white;
    background-color: var(--brand-color-lt);
    padding: 10px;
    width: 50%;
    border-radius: 10px;
    border: none;
    margin-top: 10px;
    font-size: large;
}

/* Keyframe for rotating animation */
@keyframes rotate {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}


/* Button styling */
.ban-btn {
    background-color: red;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: 300ms ease-in-out;
    border: 1px solid red;
}

.ban-btn:hover{
    background-color: transparent;
    color: black;
}

.ban-btn.green {
    background-color: var(--brand-color);
}


/* Google maps Section */

.map {
    background-color: var(--brand-color);
    padding: 0rem 0;
    margin: 1rem;
    border-radius: 10px;
}

.map h2 {
    text-align: center;
    margin-bottom: 1rem;
    color: white;
    border: 0;
}

.map iframe {
    width: 100%;
}
    </style>
    <!-- Page title -->
    <title>Healtha - Dashboard</title>
  </head>
  <body>
    <!-- Main container for the body content -->
    <div class="main-body">
      <!-- Navigation section -->
      <div class="dash-nav">
        <!-- Logo section -->
        <div class="top-logo">
          <span class="material-symbols-rounded"> radar </span>
          <h2>Radar.</h2>
        </div>
        <!-- Navigation buttons section -->
        <div class="nav-btns">
          <ul>
            <li>
              <button class="active li-btn" data-target="dashboard-screen">
                <span class="material-symbols-rounded"> dashboard </span>
                <p>Dashboard</p>
              </button>
            </li>
            <li>
              <button class="li-btn" data-target="account-screen">
                <span class="material-symbols-rounded"> account_box </span>
                <p>Accounts</p>
              </button>
            </li>
            <li>
              <button class="li-btn" data-target="ticket-screen">
                <span class="material-symbols-rounded">
                  confirmation_number
                </span>
                <p>Tickets</p>
              </button>
            </li>
          </ul>
        </div>
      </div>
      <!-- Main dashboard screen -->
      <div class="dash-screen">
        <div class="dash-top-screen">
          <h2 class="screen-title">Dashboard</h2>
          <div class="top-screen-right">
            <div class="btn-cont-rf">
              <p id="rf-state"></p>
              <button class="refresh-button" id="rf-btn">
                <i class="fa-solid fa-arrows-rotate"></i>
              </button>
            </div>
            <button class="logout">
              <span class="material-symbols-rounded"> logout </span>
            </button>
          </div>
        </div>
        <div class="dash-screen-main">
          <div class="main-contained">
            <!-- Dashboard overview section -->
            <div
              class="dashboard-screen active off dashboard"
              id="dashboard-screen"
            >
              <div class="overview-box-cont">
                <div class="overview-box">
                  <h3>Accounts</h3>
                  <p id="count-icons">
                    <span class="material-symbols-rounded"> account_box </span>
                  </p>
                  <p id="number-avail">
                      <span>Total: </span>
                      <span class="bus-count">10</span>
                  </p>
                </div>
                <div class="overview-box">
                  <h3>Tickets</h3>
                  <p id="count-icons">
                    <span class="material-symbols-rounded">
                      confirmation_number
                    </span>
                  </p>
                  <p id="number-avail">
                    <span>Total: </span>
                    <span class="bus-count">10</span>
                </p>
                </div>
                <div class="overview-box">
                  <h3>Buses</h3>
                    <p id="count-icons">
                      <span class="material-symbols-rounded">
                        directions_bus
                      </span>
                    </p>
                    <p id="number-avail">
                      <span>Total: </span>
                      <span class="bus-count">10</span>
                  </p>
                </div>
                <!-- <div class="overview-box">
                  <h3>Transactions</h3>
                </div> -->
              </div>
              <!-- <div class="overview-tables">
                            Map container
                            <div id='myMap'></div>
                        </div> -->
              <div class="map">
                <h2>Map Container</h2>
                <iframe
                  src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d63427.14407162616!2d3.345646075740742!3d6.496788217402196!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x103b8cf3ea9e2d33%3A0xdc48a40ac59ed2a5!2sLagos%20Mainland%2C%20Lagos%20101245%2C%20Lagos!5e0!3m2!1sen!2sng!4v1716548460535!5m2!1sen!2sng&zoom=14"
                  height="400"
                  loading="lazy"
                  style="border:0;"
                  referrerpolicy="no-referrer-when-downgrade"
                ></iframe>
              </div>
            </div>
            <!-- Accounts section -->
            <div class="account-screen off registers" id="account-screen">
              <div class="screen-top-contained">
                <div class="stc-left">
                  <div class="btn-cont-rf">
                    <div class="btn-actions">
                      <!-- <button class="active-action-btn" type="button" id="activeActionBtn" aria-expanded="false" data-target="account-modal">
                                            <span class="material-symbols-rounded">add</span>
                                            <p>Add</p>
                                        </button> -->
                    </div>
                  </div>
                </div>
                <div class="dropdown">
                  <div class="pagination-section-aab">
                    <label for="paginationSwitch">Enable Pagination:</label>
                    <input
                      type="checkbox"
                      id="paginationSwitch"
                      data-page="account-screen"
                      checked
                    />
                  </div>
                </div>
              </div>
              <!-- Search filter section -->
              <div class="search-filter">
                <div class="search-contained-area">
                  <div class="row" id="search">
                    <form
                      id="search-form"
                      action=""
                      enctype="multipart/form-data"
                    >
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Search"
                      />
                      <button type="submit" class="btn btn-block btn-primary">
                        Search
                      </button>
                    </form>
                  </div>
                </div>
              </div>
              <!-- Accounts table section -->
              <div class="table-structure">
                <table id="accountTable">
                  <thead>
                    <tr>
                      <th>Username</th>
                      <th>Full Name</th>
                      <!-- <th>Last Name</th> -->
                      <th>Email</th>
                      <th>Phone No.</th>
                      <th>Balance</th>
                      <th>Status</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Register data will be inserted here -->
                  </tbody>
                </table>
                <!-- Pagination controls -->
                <div id="pagination">
                  <button id="prevBtn">
                    <i class="fa-solid fa-circle-chevron-left"></i>
                  </button>
                  <span id="pageInfo"
                    >Page <span id="currentPage">1</span> of
                    <span id="totalPages">1</span></span
                  >
                  <button id="nextBtn">
                    <i class="fa-solid fa-circle-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>
            <!-- Patients section -->
            <div class="ticket-screen off patients" id="ticket-screen">
              <div class="screen-top-contained">
                <div class="stc-left">
                  <h1 class="screen-table-name">All Patients</h1>
                </div>
                <div class="dropdown">
                  <div class="pagination-section-aab">
                    <label for="paginationSwitch">Enable Pagination:</label>
                    <input
                      type="checkbox"
                      id="paginationSwitch"
                      data-page="ticket-screen"
                      checked
                    />
                  </div>
                  <div class="btn-actions">
                    <button
                      class="active-action-btn"
                      type="button"
                      id="activeActionBtn"
                      aria-expanded="false"
                      data-target="patientForm"
                    >
                      <i class="fas fa-plus"></i>
                      <!-- Default icon (add) -->
                      Add
                    </button>
                    <button
                      class="dropdown-toggle"
                      type="button"
                      id="dropdownMenuButton"
                      data-toggle="dropdown"
                      aria-haspopup="true"
                      aria-expanded="false"
                    >
                      <i class="fa-solid fa-caret-down"></i>
                    </button>
                  </div>
                </div>
              </div>
              <!-- Search filter section -->
              <div class="search-filter">
                <div class="search-contained-area">
                  <div class="row" id="search">
                    <form
                      id="search-form"
                      action=""
                      enctype="multipart/form-data"
                    >
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Search"
                      />
                      <button type="submit" class="btn btn-block btn-primary">
                        Search
                      </button>
                    </form>
                  </div>
                </div>
              </div>
              <!-- Patients table section -->
              <div class="table-structure">
                <table id="patientTable">
                  <thead>
                    <tr>
                      <th>Reg. Id</th>
                      <th>Name</th>
                      <th>Age</th>
                      <th>Gender</th>
                      <th>Department</th>
                      <th>Phone No.</th>
                      <th>Date</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Patient data will be inserted here -->
                  </tbody>
                </table>
                <!-- Pagination controls -->
                <div id="pagination">
                  <button id="prevBtn">
                    <i class="fa-solid fa-circle-chevron-left"></i>
                  </button>
                  <span id="pageInfo"
                    >Page <span id="currentPage">1</span> of
                    <span id="totalPages">1</span></span
                  >
                  <button id="nextBtn">
                    <i class="fa-solid fa-circle-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>
            <!-- Payments section -->
            <div class="payment-screen off payments" id="payment-screen">
              <div class="screen-top-contained">
                <div class="stc-left">
                  <h1 class="screen-table-name">All Payments</h1>
                </div>
                <div class="dropdown">
                  <div class="pagination-section-aab">
                    <label for="paginationSwitch">Enable Pagination:</label>
                    <input
                      type="checkbox"
                      id="paginationSwitch"
                      data-page="payment-screen"
                      checked
                    />
                  </div>
                  <div class="btn-actions">
                    <button
                      class="active-action-btn"
                      type="button"
                      id="activeActionBtn"
                      aria-expanded="false"
                      data-target="patientForm"
                    >
                      <i class="fas fa-plus"></i>
                      <!-- Default icon (add) -->
                      Add
                    </button>
                    <button
                      class="dropdown-toggle"
                      type="button"
                      id="dropdownMenuButton"
                      data-toggle="dropdown"
                      aria-haspopup="true"
                      aria-expanded="false"
                    >
                      <i class="fa-solid fa-caret-down"></i>
                    </button>
                  </div>
                </div>
              </div>
              <!-- Search filter section -->
              <div class="search-filter">
                <div class="search-contained-area">
                  <div class="row" id="search">
                    <form
                      id="search-form"
                      action=""
                      enctype="multipart/form-data"
                    >
                      <input
                        class="form-control"
                        type="text"
                        placeholder="Search"
                      />
                      <button type="submit" class="btn btn-block btn-primary">
                        Search
                      </button>
                    </form>
                  </div>
                </div>
              </div>
              <!-- Payments table section -->
              <div class="table-structure">
                <table id="paymentTable">
                  <thead>
                    <tr>
                      <th>Transaction ID</th>
                      <th>Patient ID</th>
                      <th>Amount</th>
                      <th>Date</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Payment data will be inserted here -->
                  </tbody>
                </table>
                <!-- Pagination controls -->
                <div id="pagination">
                  <button id="prevBtn">
                    <i class="fa-solid fa-circle-chevron-left"></i>
                  </button>
                  <span id="pageInfo"
                    >Page <span id="currentPage">1</span> of
                    <span id="totalPages">1</span></span
                  >
                  <button id="nextBtn">
                    <i class="fa-solid fa-circle-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>
            <!-- Default screen message -->
            <!-- <p>Display the selected screen here</p> -->
          </div>
        </div>
      </div>
    </div>
    <!-- Import external JS libraries -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
      integrity="sha512-oH/G1ib8DME67U2N5L57u4eyM7fDP78vw2D4sqS8B9SA7U4A/0sGYaGncB4Jo/JjvRJgzjtMFLHCS0wUD8jdiQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"
      integrity="sha512-fuop+HlSMTE7OnkmkJ5A8z3RmZEKPXkD+Hp1LgSaQk5KYukMLrNPkt7+gDyy4hb2f6CUX0TiBqiIINmtoPSm6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
    <!-- Link to the custom admin JS file -->
    <!-- <script src="{% static 'js/nav.js' %}"></script>
    <script src="{% static 'js/accounts.js' %}"></script> -->
    <script>
      const theButtons = document.querySelectorAll(".li-btn");

// Add click event listeners to each side navigation button
theButtons.forEach((tab) => {
  tab.addEventListener("click", (event) => {
    const title = document.querySelector(".screen-title");
    const listItems = document.querySelectorAll(".li-btn");
    const divs = document.querySelectorAll(".main-contained > div");

    // Remove 'active' class from all list items and divs
    listItems.forEach((item) => item.classList.remove("active"));
    divs.forEach((div) => div.classList.remove("active"));

    // Add 'active' class to the clicked tab and its corresponding content div
    tab.classList.add("active");
    const pageTitle = tab.querySelector("p");
    title.textContent = pageTitle.innerText;

    const targetDivId = tab.getAttribute("data-target");
    const page = document.getElementById(targetDivId);
    page.classList.add("active");

    // Store the new active page in local storage
    storeActiveSection(targetDivId);
  });
});


// Function to store the active section in local storage
function storeActiveSection(sectionId) {
    localStorage.setItem("activeSection", sectionId);
  }
  
  // Function to get the active section from local storage
  function getActiveSection() {
    return localStorage.getItem("activeSection");
  }
  
  // Function to restore the active section based on stored data in local storage
  function restoreActiveSection() {
    const activeSectionId = getActiveSection();
    if (activeSectionId) {
      const activeTab = document.querySelector(
        `[data-target="${activeSectionId}"]`
      );
      if (activeTab) {
        activeTab.click(); // Trigger click to show the active section
      }
    }
  }
  
    </script>

    <script>
      // Define arrays for tables
let users = [];
let dbUsers = [];

// Define variables for pagination
const itemsPerPage = 10;
let currentPage = 1;
let totalUsers = 0;
let totalPages = 1;

// Function to populate the account table with users based on pagination
const populateAccountTable = (users, page) => {
  const tbody = document.querySelector("#accountTable tbody");
  tbody.innerHTML = ""; // Clear existing rows

  const startIndex = (page - 1) * itemsPerPage;
  const endIndex = startIndex + itemsPerPage;
  const displayedUsers = users.slice(startIndex, endIndex);

  displayedUsers.forEach((user) => {
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${user.username}</td>
      <td>${user.first_name} ${user.last_name}</td>
      <td>${user.email}</td>
      <td>${user.phone_number}</td>
      <td>${user.balance}</td>
      <td class="status">${user.is_active ? "active" : "inactive"}</td>
      <td><button class="ban-btn" data-id="${user.email}">${user.is_active ? 'Ban' : 'Unban'}</button></td>
    `;

    tbody.appendChild(row);
  });
};

// Function to update pagination info
const updatePaginationInfo = () => {
  document.getElementById("currentPage").textContent = currentPage;
  document.getElementById("totalPages").textContent = totalPages;
};

// Function to handle pagination navigation
const navigatePagination = (direction) => {
  if (direction === "next" && currentPage < totalPages) {
    currentPage++;
  } else if (direction === "prev" && currentPage > 1) {
    currentPage--;
  }

  // Repopulate the account table with users for the updated page
  populateAccountTable(dbUsers, currentPage);
  updatePaginationInfo();
};

// Event listener for next and previous pagination buttons
document
  .querySelector("#nextBtn")
  .addEventListener("click", () => navigatePagination("next"));
document
  .querySelector("#prevBtn")
  .addEventListener("click", () => navigatePagination("prev"));

// Function to filter users based on search input
const filterUsers = (searchInput) => {
  const filteredUsers = dbUsers.filter((user) => {
    const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();
    return fullName.includes(searchInput.toLowerCase());
  });

  // Repopulate the account table with filtered users
  currentPage = 1;
  totalUsers = filteredUsers.length;
  totalPages = Math.ceil(totalUsers / itemsPerPage);
  populateAccountTable(filteredUsers, currentPage);
  updatePaginationInfo();
};

// Event listener for search form submission
document.getElementById("search-form").addEventListener("submit", (event) => {
  event.preventDefault();
  const searchInput = event.target.querySelector("input").value;
  filterUsers(searchInput);
});

// Event listener for search input changes
document.getElementById("search-form").addEventListener("input", (event) => {
  const searchInput = event.target.value;
  filterUsers(searchInput);
});

// Function to handle refresh button click
const handleRefresh = () => {
  const rfElement = document.getElementById("rf-btn");
  const rfpState = rfElement.previousElementSibling;
  rfElement.style.animation = "rotate 1s infinite";
  rfpState.textContent = "Getting...";

  fetchUsers().then(() => {
    rfpState.textContent = "Up to date";
    rfElement.style.animation = "none";
    setTimeout(() => {
      rfpState.textContent = "";
    }, 2000);

    // Repopulate the account table with users for the current page
    populateAccountTable(dbUsers, currentPage);
  });
};

document.getElementById("rf-btn").addEventListener("click", handleRefresh);

// Event listener for ban buttons
document.querySelector("#accountTable").addEventListener("click", (event) => {
  if (event.target.classList.contains("ban-btn")) {
    const button = event.target;
    const userId = button.dataset.email;
    const statusCell = button.closest("tr").querySelector(".status");

    if (statusCell.textContent === "inactive") {
      // Confirm the user's intention to unban
      if (confirm("Are you sure you want to unban this user?")) {
        // Simulate a successful unban operation for demonstration purposes
        setTimeout(() => {
          alert("User unbanned successfully.");
          // Update the table or any other necessary action
          statusCell.textContent = "active";
          button.textContent = "Ban";
          button.style.backgroundColor = "red";
        }, 1000);
      }
    } else {
      // Confirm the user's intention to ban
      if (confirm("Are you sure you want to ban this user?")) {
        // Simulate a successful ban operation for demonstration purposes
        setTimeout(() => {
          alert("User banned successfully.");
          // Update the table or any other necessary action
          statusCell.textContent = "inactive";
          button.textContent = "Unban";
          button.style.backgroundColor = "green";
        }, 1000);
      }
    }

    // Commented out fetch API to send status to backend
    /*
      fetch(`/api/users/${userId}/status`, {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify({ status: statusCell.textContent }),
      })
      .then(response => response.json())
      .then(data => {
          console.log('Success:', data);
      })
      .catch((error) => {
          console.error('Error:', error);
      });
    */
  }
});

// Function for Tickets
const fetchTickets = async () => {
  const targetUrl = '/get_all_tickets/'

  try {
    const response = await fetch(targetUrl, {
      method: 'GET'
    });
    const result = await response.json();
    const tickets = result.tickets;
  } catch (error) {
    
  }
}


const fetchUsers = async () => {
  try {
    // const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
    const targetUrl = '/get_all_users/';

    const response = await fetch(targetUrl, {
      method: 'GET'
    });

    const result = await response.json();
    const users = result.users; // Extract the users array from the response
    const wallets = result.wallet; // Extract the wallets array from the response
    console.log(users, wallets);

    // Merge the users and wallets data
    dbUsers = users.map(user => {
      const wallet = wallets.find(w => w.user_id === user.user_id);
      return {
        ...user,
        balance: wallet ? wallet.wallet_balance : '0.00'
      };
    });

    totalUsers = dbUsers.length;
    totalPages = Math.ceil(totalUsers / itemsPerPage);
    populateAccountTable(dbUsers, currentPage);
    updatePaginationInfo();
  } catch (error) {
    console.error('Error fetching users:', error);
  }
};

// Call the fetchUsers function
fetchUsers();



// Get Total
var userTotal;
    </script>
  </body>
</html>
